\documentclass[a4paper,12pt]{report}

\usepackage{float}
\usepackage{hyperref}

\begin{document}
\tableofcontents

\title{relazione}

\chapter{Analisi dei requisiti}
\section{Intervista}
Vogliamo sviluppare un social network puramente testuale.
Gli utenti possono iscriversi e disicriversi. Al momento dell'iscrizione l'utente inserisce le sue generalità, opzionalmente la propria locazione, una email e decide un nome utente univoco e una password.
L'utente può cambiare la sua password ma non può riutilizzare una password precedente.
Ogni utente può pubblicare dei post. Un post consiste in un testo scritto, opzionalmente accompagnato da una locazione decisa dall'autore. 
Per ogni post Viene anche registrata la timestamp.
Ogni utente può commentare i post e rispondere ad altri commenti.
L'utente può correggere post e commenti.
L'utente ha una reputazione, definita come il numero di like totali ricevuti meno il numero totale di dislike ricevuti.
Ogni utente può mettere like e dislike a post e commenti.
Gli utenti inoltre possono seguire altri utenti.
Gli utenti possono chattare con altri utenti. Le chat si compongono di messaggi inviati da utenti. Ogni messaggio ha un suo autore, un timestamp di invio e, dopo essere stato letto, un timestamp di lettura.
Ogni utente può creare un gruppo. Un gruppo è una aggregazione di uno o più utenti. Ogni gruppo ha uno o più utenti amministratori.
Ogni gruppo ha una e una sola chat interna a cui possono partecipare solo gli utenti membri.

\section{Definizione delle specifiche in linguaggio naturale ed estrazione dei concetti principali}
Vogliamo sviluppare un social network puramente testuale.
Gli \textbf{utenti} possono iscriversi e disicriversi. Al momento dell'iscrizione l'utente inserisce un username identificativo e opzionalmente le sue generalità(nome, cognome, data di nascita, proprio domicilio). Inoltre decide una password che utilzzerà per autenticarsi al social network.
L'utente può cambiare la sua password ma non può riutilizzare una password precedente.
Ogni utente può pubblicare dei \textbf{post}. Un post consiste in un titlo, un testo scritto, opzionalmente accompagnato da una locazione decisa dall'autore (cioè l'utente che ha scritto il post). I post possono essere commentati dagli utenti.
Ogni utente può mettere \textbf{like} e dislike a post e commenti. Ricevendo reazioni ai propri post e commenti gli utenti si costruiscono una reputazione, ciè un indice frutto della somma algebrica tra like e dislike.
Gli utenti inoltre possono \textbf{seguire} altri utenti e smettere di seguirli. Sarà possibile avere uno storico di queste operazioni. 
Il social fornirà ad ogni utente un feed, cioè una sequeza di post pubblicati dagli utenti da lui seguiti.
Gli utenti possono chattare con altri utenti. Le \textbf{chat} si compongono di messaggi inviati dai membri di quella chat. Ogni \textbf{messaggio} ha un suo autore, un timestamp di invio, un testo ed può citare un post o commento. Ogni messaggio inoltre può essere in risposta ad un altro messaggio di quella chat. 
Ogni utente può creare una \textbf{chat}. Ogni chat ha uno o più membri amministratori. Gli\textbf{amministratori} possono far entrare nuovi membri nelle chat di cui sono amministratori. Gli amministratori hanno diritto di cacciare degli utenti dalla chat, eventualmente comunicando una motivazione. Gli utenti possono uscire volontariamente dalle chat a cui appartengono. Gli utenti che escono volontariamente dalla chat possono lasciare una motivazione del loro gesto. 
Infine gli amministratori possono eliminare dei messaggi della chat, mentre gli utenti non amministratori non hanno questa facoltà.
\section{Definizioni}
\begin{itemize}
    \item Utente: un iscritto al nostro social network.  
    \item Post: un testo scritto da un utente 
    \item Autore di un post: l'utente che ha scritto il post
    \item Commento: un post che fa riferimento ad un altro post (detto post padre)
    \item Like: è una segnalazione di gradimento ad un post
    \item Dislike: l'opposto di un like
    \item Reputazione di un utente: la differenza tra like e dislike complessivi dei post scritti dall'utente
    \item Messaggio: un testo scritto da un utente con destinatario una chat 
    \item Chat: una sequenza di messaggi
    \item Membro di una chat: un utente che fa parte della chat  
    \item Regione: un luogo geografico
    \item Amministratore di una chat: un utente che può aggiungere e rimuovere utenti dalla chat
    \item Creatore di una chat: l'utente che ha creato la chat, in altre parole il primo membro di una chat (nonchè il primo amministratore)
\end{itemize}


\subsection{Operazioni utente}
\begin{itemize}
    \item Creare un nuovo utente
    \item Cambiare password utente
    \item Seguire utente
    \item Mandare un messaggio
    \item Postare e commentare
    \item Like/dislike
    \item Creare un gruppo
    \item Aggiungere utente al gruppo
    \item Vedere tutti i post in ordine cronologico (feed)
    \item Vedere utenti che hanno messo like a un post
    \item Leggere messaggi di una chat
    \item Login utente
    \item Aggiungere location a tabella location
    \item Vedere profilo utente (location, reputazione, post \ldots)
    \item Dare diritti amministratore ad un utente in un gruppo
\end{itemize}

\chapter{Progettazione Concettuale}
\section{Utenti}
L'entità utente ha come unico identificatore lo username. Per permettere agli utenti di seguire altri utenti abbiamo creato una associazione ad anello SEGUIRE. Però per permettere la creazione di uno storico dei seguiti abbiamo reificato questa associazione.
\subsection{Login e logout}
Ogni qual volta l'utente entra nel social network viene creata una istanza di STORICO\_ACCESSO. Non riusciamo ad esprimere il vincolo secondo cui il timestamp di logout deve essere successivo a quello quello di login. 
Vogliamo invece permettere accessi in intervalli sovrapposti da parte di uno stesso utente. 

\section{Chat e membri della chat}
Quando un utente entra a fare parte di una chat viene creata una istanza di MEMBRO, identificata dalla tripla (utente, chat, data di entrata). Rimane inespresso il vincolo secondo cui un utente non far parte contemporaneamente della stessa chat. Quando un membro esce dalla chat la sua istanza non viene eliminata ma semplicemente viene creata una istanza di USCITA, la quale verrà referenziata dal membro uscito.
Modelliamo i membri amministratori come sottotipi di membri. Ogni membro ha un membro amministratore che lo ha aggiunto alla chat tranne il creatore della chat. Non riusciamo ad esprimere tramite E/R il vincolo secondo cui gli amministratori possono aggiungere utenti alle chat di cui amministratori.
\subsection{Uscita dalla chat}
L'uscita volontaria dalla chat è rapresentata dal sottotipo di USCITA chiamato VOLONTARIA. Quando invece un amministratore caccia un membro allora si crea una istanza di tipo ESILIO, la quale referenzia l'amministratore responsabile della cacciata.

\section{Regione}
Una regione può far parte di una ed una sola regione più grande, mentre una regione può contenere delle regioni più piccole. Esprimiamo questi vincoli con una relazione ad anello. Si viene perciò a formare un albero (o una foresta di alberi) che esprimono le gerarchie delle regioni geografiche. Lasciamo però inespresso il vincolo secondo cui non si debbano formare dei cicli all'interno di questa foresta, vincolo che abbiamo intenzione di imporre a livello applicativo. 

\section{Password}
Ogni utente ha uno storico di password che ci permette di impedire all'utente di riutilizzare password passate. Questo vincolo è espresso imponendo come identificatore della entità \texttt{STORICO\_PASSWORD} la tupla \texttt{(Password, UTENTE)}. Imponiamo inoltre il vincolo secondo cui un utente non può avere contemporaneamente due password creando l'identificatore \texttt{(Password, DataInserimento)}.

\section{Contenuto (post e commenti)}
Abbiamo modellizzato post e commenti in una gerarchia totale ed esclusiva dove i post veri e propri (cioè quelli pubblicati \textbf{non} in risposta a qualche altro contenuto) sono istanze della sottoclasse \texttt{POST}, mentre i commenti (cioè quei contenuti in risposta ad altri contenuti) sono rappresentati dall'entità figlia \texttt{COMMENTO}. Questa entità è legata a \texttt{CONTENUTO} dalla relazione \texttt{RISPOSTA}, che indica a quale contenuto il commento fa rifermento.
Per modellizzare la possibilità da parte degli utenti di mettere like e dislike ai contenuti abbiamo creato la relazione \texttt{REAZIONE} il cui attributo \texttt{LikeDislike} indica se la reazione è un like o un dislike. L'attributo \texttt{Timestamp} indica il momento temporale in cui l'utente ha espresso la sua reazione riguardo al contenuto. 

\section{Schema concettuale finale}
\chapter{Progettazione logica}
\section{Stima del volume dei dati}

\begin{itemize}
  \item UTENTE, E, 1000
  \item SCELTA, R, 5000
  \item STORICO\_PASSWORD, E, 5000
  \item SEGUIRE, R, 100.000
  \item SEGUE, E, 100.000
  \item SEGUIRE E, 100.000
  \item MEMBRO, E, 20000
  \item AMMINISTRATORE, E, 4000
  \item PUBBLICAZIONE, R, 20000
  \item POST, E, 20000
  \item COMMENTO, E, 200.000
  \item REAZIONE, R, 2.000.000
  \item IMPERSONAZIONE, R, 20000
  \item APPARTENENZA, R, 20000
  \item CHAT, E, 2000 
  \item AGGIUNTO, R, 20000 
  \item MESSAGGIO, E, 300000
  \item MITTENTE, R, 300000
  \item CITAZIONE, R, 10000
  \item ELIMINAZIONE, R, 5000
  \item DOMICILIO, R, 100
  \item REGIONE, E, 150.000.000
  \item PARTE\_DI, R, 150.000.000

\end{itemize}

\section{Descrizione delle operazioni principali e stima della loro frequenza}
\begin{itemize}
  \item Creare un nuovo utente, 10 / g
  \item {
    Per ogni utente
    \begin{itemize}
      \item Cambiare password 1 / 60 g
      \item Autenticazione dell'utente all'interno del social network tramite username e password 10 / g
      \item Seguire un utente 2 / g
      \item Smettere di seguire un utente 1 / 10 g
      \item Creare una nuova chat 1 / 20 g
      \item Postare e commentare 10 / g
      \item Reagire con Like/dislike a post e commenti 80 / g
      \item Leggere un post (il contentuto, l'ora di pubblicazione, l'autore, i commenti, il numero di like, se presente il luogo di pubblicazione)
      \item Scorrere i post pubblicati dagli utenti seguiti (feed) 40 / g
      \item Vedere utenti che hanno messo like a un post 1 / g
      \item Vedere profilo utente (nome, cognome, data di nascita, location) e la sua reputazione 5 / g
      \item Vedere i post pubblicati da un utente
    \end{itemize} 
  }
  \item {
      Per ogni membro di una chat
      \begin{itemize}
        \item Scrivere un messaggio nella chat 50 / g
        \item Uscire volontariamente dalla chat 1 / 100 g
        \item Elencare i membri della chat 1 / g
        \item Leggere i messaggi della chat 90 / g
      \end{itemize}
    }
  \item {
      Per ogni utente amminstratore di una chat 
      \begin{itemize}
        \item Aggiungere utenti al gruppo 1 / g
        \item Dare diritti amministratore ad un utente in un gruppo 1 / 4 g
        \item Cacciare un utente da un gruppo 1 / 10 g
        \item Eliminare un messaggio dalla chat
      \end{itemize}
    }
  \item {
      Operazioni riservate agli amministratori di sistema
      \begin{itemize}
        \item Aggiungere location a tabella location 1 / 100 g
      \end{itemize} 
    }
\end{itemize}
 
\section{Schemi di navigazione e tabelle degli accessi}

\subsection{Creare un nuovo utente}
\paragraph{Descrizione} Aggiungere alla tabella degli utenti una nuova riga e assegnargli una password 
\paragraph{Frequenza} 10 / g 
\begin{table}[h]
\paragraph{Tavola degli accessi\newline}
\begin{tabular}{|c|c|c|c|}
\hline
Concetto          & Costrutto & Accessi & Tipo \\ \hline
UTENTE            & E         & 1       & W    \\ \hline
SCELTA           & A         & 1       & W    \\ \hline
STORICO\_PASSWORD & E         & 1       & W    \\ \hline
\textit{TOTALE}   &           & 6       &      \\ \hline
\end{tabular}
\end{table}
\subsection{Cambiare password}
\paragraph{Descrizione} Aggiungere alla tabella dello storico password una nuova riga. 
\paragraph{Frequenza} 1 / 60 g 
\begin{table}[h]
\paragraph{Tavola degli accessi\newline}
\begin{tabular}{|c|c|c|c|}
\hline
Concetto          & Costrutto & Accessi & Tipo \\ \hline
UTENTE            & E         & 1       & R    \\ \hline
SCELTA            & A         & 1       & W    \\ \hline
STORICO\_PASSWORD & E         & 1       & W    \\ \hline
\textit{TOTALE}   &           & 5       &      \\ \hline
\end{tabular}
\end{table}
\subsection{Autenticazione dell'utente all'interno del social network tramite username e password}
\paragraph{Descrizione} Si controlla se esiste istanza di STORICO\_PASSWORD contentente l'username e la password inserite
\paragraph{Frequenza} 10 / g
\begin{table}[h]
\paragraph{Tavola degli accessi\newline}
\begin{tabular}{|c|c|c|c|}
\hline
Concetto          & Costrutto & Accessi & Tipo \\ \hline
UTENTE            & E         & 1       & R    \\ \hline
SCELTA            & A         & 1       & R    \\ \hline
STORICO\_PASSWORD & E         & 5       & R    \\ \hline
ACCESSO           & A         & 1       & W    \\ \hline
STORICO\_ACCESSO  & E         & 1       & W    \\ \hline
TOTALE            &           & 11      &      \\ \hline
\end{tabular}
\end{table}
\subsection{Seguire un utente} 
\paragraph{Descrizione} Si aggiunge una istanza alla tabella SEGUIRE avente come chiave la tupla (utente seguace, utente seguito)
\paragraph{Frequenza} 2 / g
\begin{table}[h]
\paragraph{Tavola degli accessi\newline}
\begin{tabular}{|c|c|c|c|}
\hline
Concetto & Costrutto & Accessi & Tipo \\ \hline
UTENTE   & E         & 1       & R    \\ \hline
SEGUE    & A         & 1       & W    \\ \hline
SEGUIRE  & E         & 1       & W    \\ \hline
UTENTE   & E         & 1       & R    \\ \hline
TOTALE   &           & 6       &      \\ \hline
\end{tabular}
\end{table}
\subsection{Smettere di seguire un utente}
\paragraph{Descrizione} Si accede all'istanza di SEGUIRE identificata dalla tupla (utente seguace, utente seguito) e si aggiunge assegna al campo DataFine la data attuale.
\paragraph{Frequenza} 1 / 10 g
\begin{table}[h]
\paragraph{Tavola degli accessi\newline}
\begin{tabular}{|c|c|c|c|}
\hline
Concetto & Costrutto & Accessi & Tipo \\ \hline
UTENTE   & E         & 1       & R    \\ \hline
SEGUE    & A         & 1       & R    \\ \hline
SEGUIRE  & E         & 1       & W    \\ \hline
UTENTE   & E         & 1       & R    \\ \hline
TOTALE   &           & 5       &      \\ \hline
\end{tabular}
\end{table}
\subsection{Creare una nuova chat}
\paragraph{Descrizione} Viene creato una nuova istanza di CHAT e un primo membro amminstratore della chat.
\paragraph{Frequenza} 1 / 20 g
\begin{table}[h]
\paragraph{Tavola degli accessi\newline}
\begin{tabular}{|c|c|c|c|}
\hline
Concetto       & Costrutto & Accessi & Tipo \\ \hline
UTENTE         & E         & 1       & R    \\ \hline
IMPERSONAZIONE & A         & 1       & W    \\ \hline
AMMINISTRATORE & E         & 1       & W    \\ \hline
APPARTENENZA   & A         & 1       & W    \\ \hline
CHAT           & E         & 1       & W    \\ \hline
TOTALE         &           & 9       &      \\ \hline
\end{tabular}
\end{table}
\subsection{Postare e commentare}
\paragraph{Descrizione}
\paragraph{Frequenza} 10 / g
\begin{table}[t]
\paragraph{Tavola degli accessi\newline}
\begin{tabular}{|c|c|c|c|}
\hline
Concetto             & Costrutto & Accessi & Tipo \\ \hline
CONTENUTO            & E         & 1       & W    \\ \hline
PUBBLICAZIONE        & A         & 1       & W    \\ \hline
UTENTE               & E         & 1       & R    \\ \hline
LUOGO\_PUBBLICAZIONE & A         & 1       & W    \\ \hline
REGIONE              & E         & 1       & R    \\ \hline
RISPOSTA             & A         & 1       & W    \\ \hline
CONTENUTO            & E         & 1       & R    \\ \hline
TOTALE               &           & 11      &      \\ \hline
\end{tabular}
\end{table}
\subsection{Reagire con like/dislike a post e commenti}
\paragraph{Descrizione} Si aggiunge una istanza alla tabella reazione con identificatore la tupla (utente, contenuto) e nel campo LikeDislike +1 se è un like, -1 se è un dislike.
\paragraph{Frequenza} 80 / g
\paragraph{Tavola degli accessi}

\subsection{Leggere un post}
\paragraph{Descrizione} Si mostrano il contentuto, l'ora di pubblicazione, l'autore, i commenti, il numero di like netto (cioè la somma algebrica dei like e dislike), se presente il luogo di pubblicazione.
\paragraph{Frequenza} 100 / g
\paragraph{Tavola degli accessi}

\subsection{Scorrere il post pubblicati dagli utenti seguiti (feed)}
\paragraph{Descrizione} Questa operazione mostra in ordine cronologico i titoli, il numero di like netto e l'autore dei post pubblicati dagli utenti seguiti.
\paragraph{Frequenza} 40 / g
\paragraph{Tavola degli accessi}

\subsection{Vedere quali utenti hanno reagito ad un contenuto}
\paragraph{Descrizione} Si scorre la tabella REAZIONE e si estraggono tutte quelle in cui appare il contentuto cercato. 
\paragraph{Frequenza} 1 / g
\paragraph{Tavola degli accessi}

\subsection{Vedere il profilo di un utente}
\paragraph{Descrizione} Si mostrano nome , cognome, data di nascita, location e la sua reputazione.
\paragraph{Frequenza} 5 / g
\paragraph{Tavola degli accessi}

\subsection{Vedere i contenuti pubblicati da un utente}
\paragraph{Descrizione} Si mostrano tutti i contenuti che hanno come autore l'utente considerato
\paragraph{Frequanza} 1 / g
\paragraph{Tavola degli accessi}

\subsection{Scrivere un messaggio nella chat}
\paragraph{Descrizione} Si aggiunge una istanza nella tabella MESSAGGIO con una referenza esterna al membro autore.
\paragraph{Frequenza} 50 / g 
\paragraph{Tavola degli accessi}

\subsection{Uscire volontariamente dalla chat}
\paragraph{Descrizione} Nell'istanza del membro che sta uscendo si aggiunge una referenza ad una nuova istanza USCITA di tipo VOLONTARIA.
\paragraph{Frequenza} 1 / 100 g 
\paragraph{Tavola degli accessi}

\subsection{Elencare i membri attuali della chat}
\paragraph{Descrizione} Vengono elencati gli username, ruolo e data di entrata degli utenti membri della chat.
\paragraph{Frequenza} 1 / g
\paragraph{Tavola degli accessi}

\subsection{Leggere i messaggi della chat}
\paragraph{Descrizione} Ordinati dal più recente al più vecchio vengono mostrati il contenuto dei messaggi, il mittente, un eventuale messaggio citato e un eventuale contenuto in riferimento. Verranno ignorati i messaggi eliminati.
\paragraph{Frequenza} 90 / g
\paragraph{Tavola degli accessi}

\subsection{Aggiungere utenti al gruppo}
\paragraph{Descrizione} Viene creata una nuova istanza nella tabella MEMBRO che fa riferimento all'utente aggiunto, alla chat in cui è stato inserito, la data di entrata e il membro amministratore che lo ha aggiunto.
\paragraph{Frequenza} 1 / g
\paragraph{Tavola degli accessi}

\subsection{Dare diritti amministratore ad un utente in un gruppo}
\paragraph{Descrizione} L'operazione viene svolta come una uscita volontaria da parte del membro candidato a diventare amministratore e il suo reinserimento come membro amministratore.
\paragraph{Frequenza} 1 / 4 g
\paragraph{Tavola degli accessi}

\subsection{Cacciare un utente da un gruppo}
\paragraph{Descrizione} Similmente a come avviene l'uscita volontaria, l'istanza del membro cacciato referenzierà una istanza della tabella USCITA del tipo ESILIO.
\paragraph{Frequenza} 1 / 10 g
\paragraph{Tavola degli accessi}

\subsection{Eliminare un messaggio dalla chat}
\paragraph{Descrizione} Verrà creata una istanza della relazione ELIMINAZIONE identificata dalla tupla (messaggio eliminato, amministratore responsabile della eliminazione).
\paragraph{Frequenza} 5 / g
\paragraph{Tavola degli accessi}

\subsection{Aggiungere regione a tabella REGIONE}
\paragraph{Descrizione} Viene creata una nuova istanza di REGIONE la quale conterrà la denominazione della regione e eventualmente la regione superiore.
\paragraph{Frequenza} 1 / 100 g
\paragraph{Tavola degli accessi}

\section{Raffinamento dello schema (eliminazione di identificatori esterni, attributi composti e gerarchie, scelta delle chiavi)}
\section{Analisi delle ridondanze}
\section{Traduzione di entità e associazioni in relazioni}
\section{Schema relazionale finale}
\section{Traduzione delle operazioni in query SQL}
\chapter{Progettazione dell'applicazione}
\section{Descrizione dell'architettura dell'applicazione realizzata con obbligo di inserire alcuni screenshot dell'interfaccia utente}

\end{document}
